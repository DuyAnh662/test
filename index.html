<!DOCTYPE html>
<html lang="vi">

<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-92KE83JEYM"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }
        gtag('js', new Date());

        gtag('config', 'G-92KE83JEYM');
    </script>
    <meta charset="utf-8" />
    <title>B·∫£ng Th√¥ng B√°o BTVN - 26/9/2025</title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <style>
        :root {
            --bg: #f0f8ff;
            --card: #fff;
            --text: #333;
            --accent: #0066cc;
            --note-bg: #fff3cd;
            --note-border: #ff9900;
        }
        
        body {
            margin: 16px;
            font-family: "Arial", sans-serif;
            background: var(--bg);
            color: var(--text);
            transition: background .25s, color .25s;
        }
        /* dark */
        
        body.dark {
            --bg: #0f0f10;
            --card: #161617;
            --text: #e8eefc;
            --accent: #66b2ff;
            --note-bg: #3a2e00;
            --note-border: #ffcc00;
        }
        /* Menu */
        
        .menu {
            position: fixed;
            top: 18px;
            right: 18px;
            z-index: 1200;
        }
        
        .menu-btn {
            background: var(--accent);
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(0, 0, 0, .15);
        }
        
        .menu-panel {
            display: none;
            position: absolute;
            top: 44px;
            right: 0;
            width: 210px;
            background: var(--card);
            border-radius: 8px;
            box-shadow: 0 8px 28px rgba(0, 0, 0, .25);
            overflow: hidden;
        }
        
        .menu-panel button {
            display: block;
            width: 100%;
            padding: 10px 12px;
            border: none;
            background: transparent;
            text-align: left;
            cursor: pointer;
            color: var(--text);
        }
        
        .menu-panel button:hover {
            background: rgba(0, 0, 0, .04);
        }
        
        body.dark .menu-panel button:hover {
            background: rgba(255, 255, 255, .02);
        }
        /* popup */
        
        .popup {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, .45);
            z-index: 1100;
            align-items: center;
            justify-content: center;
        }
        
        .popup.open {
            display: flex;
        }
        
        .popup-card {
            width: 360px;
            max-width: calc(100% - 40px);
            background: var(--card);
            color: var(--text);
            padding: 18px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, .35);
            position: relative;
        }
        
        .popup-card .close {
            position: absolute;
            right: 10px;
            top: 8px;
            cursor: pointer;
            font-size: 18px;
            opacity: .85;
        }
        /* layout: two column on wide screens */
        
        .wrap {
            display: flex;
            flex-direction: column;
            gap: 20px;
            max-width: 1200px;
            margin: 80px auto 40px;
        }
        
        @media(min-width:900px) {
            .wrap {
                flex-direction: row;
                align-items: flex-start;
            }
        }
        
        .card {
            background: var(--card);
            color: var(--text);
            padding: 18px;
            border-radius: 12px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, .12);
        }
        
        .card.half {
            width: 100%;
        }
        
        @media(min-width:900px) {
            .card.half {
                width: 48%;
            }
        }
        
        h1 {
            color: var(--accent);
            margin: 6px 0 12px;
            text-align: center;
        }
        
        h2 {
            margin: 10px 0;
            color: var(--text);
            border-left: 6px solid var(--accent);
            padding-left: 10px;
        }
        
        .note {
            background: var(--note-bg);
            border-left: 6px solid var(--note-border);
            padding: 10px 12px;
            border-radius: 8px;
            color: inherit;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        
        th,
        td {
            border: 1px solid rgba(0, 0, 0, .15);
            padding: 8px 10px;
            text-align: left;
        }
        
        th {
            background: rgba(0, 0, 0, .04);
            color: var(--accent);
            font-weight: 700;
        }
        
        tr:nth-child(even) td {
            background: rgba(0, 0, 0, .03);
        }
        
        body.dark th {
            background: rgba(0, 0, 0, .22);
        }
        
        body.dark tr:nth-child(even) td {
            background: rgba(255, 255, 255, .02);
        }
        
        body.dark td {
            border-color: rgba(255, 255, 255, .06);
        }
        
        #showFullBtn {
            background: var(--accent);
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            margin-top: 12px;
        }
        
        #showFullBtn:hover {
            opacity: .95;
        }
        /* report fixed */
        
        #reportFixed {
            position: fixed;
            right: 18px;
            bottom: 18px;
            background: #ff4d4d;
            color: #fff;
            padding: 10px 12px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            box-shadow: 0 8px 20px rgba(0, 0, 0, .2);
            z-index: 1000;
        }
        /* small styling for "editable" */
        
        .editable {
            padding: 4px 6px;
            border-radius: 6px;
            background: rgba(0, 0, 0, 0.02);
            display: inline-block;
            cursor: text;
        }
        
        .save-truc {
            display: inline-block;
            margin-left: 8px;
            padding: 4px 8px;
            border-radius: 6px;
            background: var(--accent);
            color: white;
            border: none;
            cursor: pointer;
        }
        
        .inline-note {
            margin-top: 10px;
            display: block;
            color: rgba(0, 0, 0, .6);
        }
        
        body.dark .inline-note {
            color: rgba(255, 255, 255, .6);
        }
        
        .changelog {
            background-color: #1e293b;
            /* n·ªÅn xanh ƒë·∫≠m */
            
            color: #e2e8f0;
            /* m√†u ch·ªØ s√°ng */
            
            border-radius: 10px;
            padding: 15px 20px;
            margin: 20px 0;
            border-left: 5px solid #60a5fa;
            /* vi·ªÅn xanh nh·∫°t b√™n tr√°i */
            
            font-family: Arial, sans-serif;
        }
        
        .changelog h3 {
            margin-top: 0;
            color: #ffffff;
            /* ti√™u ƒë·ªÅ tr·∫Øng */
        }
        
        .changelog ul {
            list-style-type: disc;
            padding-left: 20px;
        }
        
        .changelog li {
            margin: 6px 0;
            color: #93c5fd;
            /* ch·ªØ xanh nh·∫°t */
        }
        
        .changelog {
            border-radius: 10px;
            padding: 15px 20px;
            margin: 20px 0;
            font-family: Arial, sans-serif;
            transition: background .25s, color .25s;
        }
        /* Light mode (m·∫∑c ƒë·ªãnh) */
        
        body:not(.dark) .changelog {
            background: #f8fafc;
            color: #1e293b;
            border-left: 5px solid #2563eb;
        }
        
        body:not(.dark) .changelog h3,
        body:not(.dark) .changelog strong {
            color: #111827;
        }
        
        body:not(.dark) .changelog li {
            color: #2563eb;
        }
        /* Dark mode */
        
        body.dark .changelog {
            background: #1e293b;
            color: #e2e8f0;
            border-left: 5px solid #60a5fa;
        }
        
        body.dark .changelog h3,
        body.dark .changelog strong {
            color: #ffffff;
        }
        
        body.dark .changelog li {
            color: #93c5fd;
        }
        
        .menu-panel a.donate-btn {
            display: block;
            width: 100%;
            padding: 10px 12px;
            text-align: left;
            text-decoration: none;
            color: var(--text);
            font-weight: 600;
        }
        
        .menu-panel a.donate-btn:hover {
            background: rgba(0, 0, 0, .04);
        }
        
        body.dark .menu-panel a.donate-btn:hover {
            background: rgba(255, 255, 255, .08);
        }
        /* Popup ƒë·∫πp h∆°n */
        
        .popup-card {
            width: 420px;
            max-width: calc(100% - 40px);
            background: var(--card);
            color: var(--text);
            padding: 22px 20px;
            border-radius: 14px;
            box-shadow: 0 12px 40px rgba(0, 0, 0, .4);
            position: relative;
            border-top: 6px solid var(--accent);
            animation: popupIn .3s ease;
        }
        /* hi·ªáu ·ª©ng m·ªü */
        
        @keyframes popupIn {
            from {
                transform: translateY(-20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        .popup-card h3 {
            margin: 0 0 12px;
            font-size: 20px;
            font-weight: 700;
            color: var(--accent);
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .popup-card h3::before {
            content: "‚ö†Ô∏è";
        }
        
        .popup-card ul {
            margin: 0;
            padding-left: 20px;
        }
        
        .popup-card li {
            margin: 6px 0;
            line-height: 1.5;
        }
        
        .popup-card li strong {
            color: var(--accent);
        }
        
        .popup-card .close {
            position: absolute;
            right: 12px;
            top: 10px;
            cursor: pointer;
            font-size: 18px;
            opacity: .75;
            transition: .2s;
        }
        
        .popup-card .close:hover {
            opacity: 1;
            transform: scale(1.1);
        }
        
        .popup-card .footer-check {
            margin-top: 14px;
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 14px;
            opacity: .85;
        }
        /* Popup 3D ƒë·∫πp h∆°n */
        
        .popup-card {
            width: 420px;
            max-width: calc(100% - 40px);
            background: var(--card);
            color: var(--text);
            padding: 22px 20px;
            border-radius: 14px;
            /* Hi·ªáu ·ª©ng 3D b·∫±ng nhi·ªÅu l·ªõp shadow */
            
            box-shadow: 0 15px 25px rgba(0, 0, 0, 0.35), 0 5px 10px rgba(0, 0, 0, 0.2), inset 0 1px 2px rgba(255, 255, 255, 0.15);
            position: relative;
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-top: 6px solid var(--accent);
            /* Gradient nh·∫π ƒë·ªÉ c√≥ c·∫£m gi√°c n·ªïi */
            
            background: linear-gradient( 145deg, rgba(255, 255, 255, 0.03), rgba(0, 0, 0, 0.15)), var(--card);
            animation: popupIn .35s ease;
            transform: translateY(0) scale(1);
            transition: transform .2s ease, box-shadow .2s ease;
        }
        /* Hover rung ƒë·ªông nh·∫π */
        
        .popup-card:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 18px 30px rgba(0, 0, 0, 0.4), 0 8px 15px rgba(0, 0, 0, 0.25), inset 0 1px 2px rgba(255, 255, 255, 0.1);
        }
        
        @keyframes popupIn {
            from {
                transform: translateY(-20px) scale(.95);
                opacity: 0;
            }
            to {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
        }
    </style>
</head>

<body>
    <!-- MENU -->
    <div class="menu" aria-hidden="false">
        <button class="menu-btn" id="menuBtn">‚ò∞ Menu</button>
        <div class="menu-panel" id="menuPanel" role="menu" aria-hidden="true">
            <button id="menuDark">üåô Chuy·ªÉn Dark/Light</button>
            <button id="menuReport">üö® Report</button>
            <button id="menuPopup">‚ùóB·∫≠t l·∫°i L∆∞u √Ω</button>
            <a href="Donate.html" target="_blank" class="donate-btn">‚ù§Ô∏è Donate to us</a>
        </div>
    </div>

    <!-- POPUP -->
    <div class="popup" id="popup">
        <div class="popup-card" id="popupCard">
            <div class="close" id="popupClose" title="ƒê√≥ng">‚úï</div>
            <h3>‚ùóL∆∞u √Ω</h3>
            <p id="popupText">+ƒê∆∞·ª£c l√†m ra v√† ph√°t tri·ªÉn b·ªüi ChatGBT(Web), V≈© Duy Anh v√† Nguy·ªÖn VƒÉn Ho√†ng B√°ch</p>
            <p id="popupText">+Trang web hi·ªán ƒëang trong giai ƒëo·∫°n ph√°t tri·ªÉn Beta s·∫Ω r·∫•t d·ªÖ ƒë·ªÉ l·∫°i sai s√≥t</p>
            <p id="popupText">+Donate ch√∫ng toi nh√©!^_^</p>
            <p style="margin-top:12px; text-align:left;">
                <label>
                    <input type="checkbox" id="dontShowToday" /> Kh√¥ng hi·ªÉn th·ªã l·∫°i h√¥m nay</label>
            </p>
        </div>
    </div>

    <!-- MAIN -->
    <div class="wrap">
        <!-- BTVN -->
        <div class="card">
            <h1>üì¢ Th√¥ng b√°o BTVN [NEW 11:45 - 26/9/2025]</h1>

            <h2>üìò ƒê·ªãa l√≠</h2>
            <ul>
                <li>T√¨m hi·ªÉu d·∫°ng ƒë·ªãa h√¨nh C√°c-xt∆° v√† h·ªçc thu·ªôc</li>
            </ul>

            <h2>‚ûó To√°n h·ªçc</h2>
            <strong>H√¨nh:</strong>
            <ul>
                <li>L√†m n·ªët b√†i th·∫ßy cho tr√™n l·ªõp</li>
                <li>√în l·∫°i b√†i c≈©</ul>
            <strong>S·ªë:</strong>
            <ul>
                <li>1.18 ‚Üí 1.23 S√°ch to√°n t·∫≠p 1 [SGK-17; 18]</li>
            </ul>

            <h2>‚úç Ng·ªØ vƒÉn</h2>
            <ul>
                <li>Hi·ªán kh√¥ng c√≥</li>
            </ul>

            <h2>üß¨ Sinh h·ªçc</h2>
            <ul>
                <li>C√≥ th·ªÉ s·∫Ω ki·ªÉm tra b√†i 32 m·ªôt s·ªë b·ªánh v·ªÅ ti√™u h√≥a</li>
            </ul>

            <h2>üè† GDƒêP</h2>
            <ul>
                <li>Ch∆∞a c√≥ b√†i</li>
            </ul>

            <h2>üìú L·ªãch s·ª≠</h2>
            <ul>
                <li>Hi·ªán kh√¥ng c√≥ b√†i[Ch∆∞a r√µ]</li>
            </ul>

            <h2>üî¨ V·∫≠t l√Ω</h2>
            <ul>
                <li>L√†m b√†i th·∫ßy ƒë√£ ƒë·ªçc tr√™n l·ªõp</li>
            </ul>

            <h2>ü§ù HƒêTN, HN</h2>
            <ul>
                <li>V·∫Ω tranh ho·∫∑c l√†m th∆° ch·ªß ƒë·ªÅ b·∫•t k√¨ ƒë·ªëi v·ªõi th∆° tranh ch·ªß ƒë·ªÅ truy·ªÅn th·ªëng tr∆∞·ªùng t·ªët ƒë·∫πp[th·ª© s√°u n·ªôp]</li>
                <li>L∆∞u √Ω nh·ªè: l√†m ra gi·∫•y
            </ul>

            <h2>üé® Mƒ© thu·∫≠t</h2>
            <ul>
                <li>V·∫Ω xong b√†i c√¥ ƒë√£ cho</li>
            </ul>

            <h2>‚öó H√≥a h·ªçc</h2>
            <ul>
                <li>Hi·ªán ch∆∞a r√µ</li>
            </ul>

            <h2>üá¨üáß Ti·∫øng Anh(Global success)</h2>
            <ul>
                <li>L√†m n·ªët b√†i 4</li>
                <li>√în l·∫°i c√°ch c√¥ng th·ª©c</li>
            </ul>

            <h2>üë• C√¥ng d√¢n</h2>
            <ul>
                <li>L√†m v·∫≠n d·ª•ng b√†i 2</li>
                <li>L√†m b√†i 1 ƒë·∫øn 4 (SGK trang 8 v√† 9)[N·∫øu ch∆∞a l√†m xong]</li>
                <li>L∆∞u √Ω nh·ªè: C√≥ th·ªÉ s·∫Ω ch·∫•m</li>
            </ul>

            <h2>üîß C√¥ng ngh·ªá</h2>
            <ul>
                <li>Ch∆∞a c√≥ b√†i</li>
            </ul>

            <h2>üé∂ √Çm nh·∫°c(S√°ch c√°nh di·ªÅu)</h2>
            <ul>
                <li>H·ªçc b√†i h√°t "B·∫£n l√†ng t∆∞∆°i ƒë·∫πp"(SGK-13)</li>
            </ul>

            <h2>üíª Tin h·ªçc</h2>
            <ul>
                <li>H·ªçc h·∫øt Ph·∫ßn 1 ho·∫∑c 2 b√†i 2(ch∆∞a r√µ)</li>
            </ul>

            <div class="note">
                <strong>L∆ØU √ù:</strong>
                <ul>
                    <li>Mu·ªën b√°o l·ªói ho·∫∑c g√≥p √Ω vui l√≤ng nh·∫≠p b·∫•m n√∫t menu r·ªìi b·∫•m report nh·∫≠p th√¥ng tin b·∫°n mu·ªën b√°o(H√£y ƒë·ªÉ t√™n b·∫°n ·ªü cu·ªëi v√† ƒë√≥ng ngo·∫∑c ghi ƒë√≥ l√† g√≥p √Ω hay b√°o l·ªói ·ªü ƒë·∫ßu ti√™n)</li>
                    <li>Th∆∞·ªùng ho·∫°t ƒë·ªông: 11h50 ‚Äì 13h00; 17h00 ‚Äì 20h45</li>
                    <li>Th√¥ng tin c√≥ th·ªÉ ch∆∞a ch√≠nh x√°c, vui l√≤ng ki·ªÉm tra l·∫°i</li>
                    <li>M·ª•c ƒë√≠ch: t·ªët cho m·ªçi ng∆∞·ªùi ‚Üí n·∫øu sai s√≥t xin b√°o l·∫°i, kh√¥ng ch·ª≠i t·ª•c</li>
                    <li>B·∫°n ƒë·ªçc hay kh√¥ng l√† quy·ªÅn c·ªßa b·∫°n, kh√¥ng v·ª´a √Ω vui l√≤ng t√¨m ngu·ªìn kh√°c</li>
                    <li>S√°ch kh√¥ng ghi c√°ch di·ªÅu hay k·∫øt n·ªëi chi th·ª©c th√¨ n·∫∑c ƒë·ªãnh n√≥ l√† k·∫øt n·ªëi chi th·ª©c</li>
                </ul>
            </div>

            <div class="changelog" style="margin-top:14px;">
                <strong>Changelog (V2.7)</strong>
                <ul>
                    <li>C·∫≠p nh·∫≠t GDCD</li>
                    <li>C·∫≠p nh·∫≠t To√°n h·ªçc (H√¨nh h·ªçc)</li>
                    <li>C·∫≠p nh·∫≠t L·ªãch s·ª≠</li>
                    <li>S·ª≠a HƒêTN</li>
                    <li>C·∫≠p nh·∫≠t Ng·ªØ vƒÉn</li>
                    <li>S·ª≠a m·ªôt v√†i th·ª© kh√°c</li>
                </ul>
            </div>
        </div>
        <!-- TKB card -->
        <div class="card half" id="tkbCard">
            <h2>üìÖ Th·ªùi kh√≥a bi·ªÉu v√† l·ªãch tr·ª±c nh·∫≠t ng√†y mai</h2>

            <div id="todayTKB">ƒêang t·∫£i...</div>

            <button id="showFullBtn">üìÖ Xem to√†n b·ªô TKB & L·ªãch tr·ª±c</button>

            <div id="fullTKB" style="display:none; margin-top:14px;"></div>
        </div>
    </div>

    <script>
        /* -------------------------
               Config / d·ªØ li·ªáu m·∫∑c ƒë·ªãnh
               ------------------------- */
        const API_URL = "https://script.google.com/macros/s/AKfycbw5sjUwJfwRtKBQQu5FgYrmgSjoQ22vvnmlv99H7YJHTVgVZRXm1vWB7fFJg8B2O2M7/exec";

        const TKB = {
            0: ["Ch·ªß nh·∫≠t: Ngh·ªâ / T·ª± h·ªçc"],
            1: ["HƒêTN,HN(CC)", "LS&ƒêL - l·ªãch s·ª≠", "Ti·∫øng anh", "LS&ƒêL - ƒê·ªãa l√≠", "To√°n h·ªçc - ƒë·∫°i s·ªë"],
            2: ["Ng·ªØ vƒÉn", "Ti·∫øng anh", "C√¥ng ngh·ªá", "HƒêTN,HN", "GDTC"],
            3: ["Ng·ªØ vƒÉn", "To√°n h·ªçc - h√¨nh h·ªçc", "KHTN - V·∫≠t l√Ω", "NT - Mƒ© thu·∫≠t", "KHTN - Sinh h·ªçc"],
            4: ["To√°n h·ªçc - ƒë·∫°i S·ªë", "Tin h·ªçc", "LS&ƒêL - l·ªãch s·ª≠", "√Çm nh·∫°c", "Ti·∫øng anh"],
            5: ["GDƒêP", "Ng·ªØ vƒÉn", "HƒêTN,HN", "To√°n h·ªçc - h√¨nh h·ªçc", "Gi√°o d·ª•c c√¥ng d√¢n"],
            6: ["KHTN - Sinh h·ªçc", "GDTC", "Ng·ªØ vƒÉn", "KHTN - H√≥a h·ªçc", "Ngh·ªâ"]
        };

        // L·ªãch tr·ª±c (c√≥ l∆∞u localStorage n·∫øu user ch·ªânh)
        let truc = JSON.parse(localStorage.getItem('lichTruc') || 'null') || {
            0: "Ch·ªß nh·∫≠t: Kh√¥ng tr·ª±c",
            1: "T·ªï 2",
            2: "T·ªï 3",
            3: "T·ªï 4",
            4: "T·ªï 1",
            5: "T·ªï 2",
            6: "T·ªï 3",
        };

        const dayNames = ["Ch·ªß Nh·∫≠t", "Th·ª© Hai", "Th·ª© Ba", "Th·ª© T∆∞", "Th·ª© NƒÉm", "Th·ª© S√°u", "Th·ª© B·∫£y"];

        /* -------------------------
           Menu
           ------------------------- */
        const menuBtn = document.getElementById('menuBtn');
        const menuPanel = document.getElementById('menuPanel');

        menuBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            menuPanel.style.display = menuPanel.style.display === 'block' ? 'none' : 'block';
        });
        window.addEventListener('click', (ev) => {
            if (!menuPanel.contains(ev.target) && ev.target !== menuBtn) menuPanel.style.display = 'none';
        });

        // Dark toggle in menu:
        const menuDark = document.getElementById('menuDark');

        function applyThemeFromStorage() {
            if (localStorage.getItem('theme') === 'dark') {
                document.body.classList.add('dark');
                menuDark.textContent = '‚òÄÔ∏è Light Mode';
            } else {
                document.body.classList.remove('dark');
                menuDark.textContent = 'üåô Dark Mode';
            }
        }
        applyThemeFromStorage();
        menuDark.addEventListener('click', () => {
            document.body.classList.toggle('dark');
            localStorage.setItem('theme', document.body.classList.contains('dark') ? 'dark' : 'light');
            applyThemeFromStorage();
        });

        // Report from menu & fixed button
        const menuReport = document.getElementById('menuReport');
        const reportFixed = document.getElementById('reportFixed');

        async function doReport() {
            const txt = prompt("‚ùóNh·∫≠p n·ªôi dung b√°o l·ªói / g√≥p √Ω:");
            if (!txt || !txt.trim()) {
                alert("‚ö†Ô∏è B·∫°n ch∆∞a nh·∫≠p n·ªôi dung.");
                return;
            }
            try {
                // g·ª≠i l√™n API n·∫øu b·∫°n c√≥ deploy; n·∫øu kh√¥ng c√≥ th√¨ th·ª≠-catch v·∫´n ok
                await fetch(API_URL, {
                    method: 'POST',
                    body: JSON.stringify({
                        text: txt
                    })
                });
                alert("‚úÖ ƒê√£ g·ª≠i. C·∫£m ∆°n b·∫°n!");
            } catch (e) {
                console.warn('Report failed (demo):', e);
                alert("‚úÖ (Demo) ƒê√£ ghi nh·∫≠n: " + txt);
            }
        }
        menuReport.addEventListener('click', doReport);
        if (reportFixed) {
            reportFixed.addEventListener('click', doReport);
        }
        // Show popup from menu
        document.getElementById('menuPopup').addEventListener('click', () => {
            openPopup(true);
            menuPanel.style.display = 'none';
        });

        /* -------------------------
           Popup logic (1 l·∫ßn/ng√†y + "Kh√¥ng hi·ªán h√¥m nay")
           ------------------------- */
        const popup = document.getElementById('popup');
        const popupClose = document.getElementById('popupClose');
        const dontShowTodayChk = document.getElementById('dontShowToday');

        function openPopup(force = false) {
            const today = new Date().toLocaleDateString('vi-VN');
            const disabled = localStorage.getItem('popupDisabled') === 'true'; // n·∫øu user t·∫Øt ho√†n to√†n (kh√¥ng d√πng ·ªü ƒë√¢y)
            if (force) {
                popup.classList.add('open');
                return;
            }
            if (disabled) return;
            const lastShown = localStorage.getItem('popupShownDate');
            if (lastShown !== today) {
                popup.classList.add('open');
                localStorage.setItem('popupShownDate', today);
            }
        }

        popupClose.addEventListener('click', () => {
            if (dontShowTodayChk.checked) {
                localStorage.setItem('popupShownDate', new Date().toLocaleDateString('vi-VN'));
            }
            popup.classList.remove('open');
        });

        // show on load
        window.addEventListener('load', () => openPopup(false));

        /* -------------------------
           TKB rendering + full view + editing tr·ª±c
           ------------------------- */
        function computeShowDay() {
            // L·∫•y gi·ªù VN
            const vnNow = new Date(new Date().toLocaleString('en-US', {
                timeZone: 'Asia/Ho_Chi_Minh'
            }));
        }

        // NOTE: small helper: get VN date/time (works cross-browser)
        function getVNDateObj() {
            const s = new Date().toLocaleString('en-US', {
                timeZone: 'Asia/Ho_Chi_Minh'
            });
            return new Date(s);
        }

        function renderTodayTKB() {
                const d = getVNDateObj();
                let day = d.getDay(); // 0..6
                const hour = d.getHours();

                // n·∫øu tr∆∞·ªõc 7h th√¨ coi nh∆∞ ng√†y h√¥m tr∆∞·ªõc
                if (hour < 7) day = (day - 1 + 7) % 7;

                // logic hi·ªÉn th·ªã: Th·ª© S√°u -> hi·ªán Th·ª© B·∫£y; Ch·ªß Nh·∫≠t -> hi·ªán Th·ª© Hai; kh√°c -> ng√†y mai
                let showDay;
                if (day === 5) showDay = 6;
                else if (day === 0) showDay = 1;
                else showDay = (day + 1) % 7;

                const container = document.getElementById('todayTKB');
                let html = `<p>H√¥m nay: <strong>${dayNames[d.getDay()]}</strong>, ${d.toLocaleDateString('vi-VN')} ‚Äî Hi·ªÉn th·ªã TKB <strong>${dayNames[showDay]}</strong></p>`;
                html += `<div class="inline-note">‚ùóL∆∞u √Ω: Sau 7:00 s√°ng TKB & l·ªãch tr·ª±c s·∫Ω chuy·ªÉn sang ng√†y ti·∫øp theo (m·ªôt v√†i quy t·∫Øc ƒë·∫∑c bi·ªát ƒë∆∞·ª£c √°p d·ª•ng).</div>`;
                html += `<table><thead><tr><th>Ti·∫øt</th><th>M√¥n / N·ªôi dung</th></tr></thead><tbody>`;
                (TKB[showDay] || []).forEach((m, i) => {
                    html += `<tr><td>${i+1}</td><td>${m}</td></tr>`;
                });
                html += `</tbody></table>`;
                html += `<p style="margin-top:10px;"><b>L·ªãch tr·ª±c: </b> <span id="todayTruc">${truc[showDay]}</span>`;

                container.innerHTML = html;

                // handle edit tr·ª±c: m·ªü prompt -> l∆∞u v√†o truc v√† localStorage (ch·ªâ admin)
                document.getElementById('editTrucBtn').addEventListener('click', () => {
                    const txt = prompt("S·ª≠a ghi ch√∫ l·ªãch tr·ª±c cho ng√†y hi·ªÉn th·ªã:", truc[showDay]);
                    if (txt !== null) {
                        truc[showDay] = txt;
                        localStorage.setItem('lichTruc', JSON.stringify(truc));
                        renderTodayTKB(); // rerender ƒë·ªÉ c·∫≠p nh·∫≠t
                    }
                });
            }
            // full week + inline ch·ªânh tr·ª±c c·ªßa t·ª´ng ng√†y
        document.getElementById('showFullBtn').addEventListener('click', function() {
            const full = document.getElementById('fullTKB');
            if (full.style.display === 'block') {
                full.style.display = 'none';
                this.textContent = 'üìÖ Xem to√†n b·ªô TKB & L·ªãch tr·ª±c';
                return;
            }
            // build full
            let html = `<div style="margin-bottom:8px;"><strong>üìÖ Th·ªùi kh√≥a bi·ªÉu c·∫£ tu·∫ßn</strong></div>`;
            for (let k = 1; k <= 6; k++) {
                html += `<h3 style="margin:8px 0 4px;">${dayNames[k]}</h3>`;
                html += `<table><thead><tr><th>Ti·∫øt</th><th>M√¥n</th></tr></thead><tbody>`;
                (TKB[k] || []).forEach((m, i) => html += `<tr><td>${i+1}</td><td>${m}</td></tr>`);
                html += `</tbody></table>`;
            }

            // m·ªôt b·∫£ng ri√™ng cho l·ªãch tr·ª±c
            html += `<hr style="opacity:.08;margin:12px 0;"><h3>üßπ L·ªãch tr·ª±c c·∫£ tu·∫ßn</h3>`;
            html += `<table><thead><tr><th>Ng√†y</th><th>T·ªï tr·ª±c</th></tr></thead><tbody>`;
            for (let k = 1; k <= 6; k++) {
                html += `<tr><td>${dayNames[k]}</td><td class="editable-truc" data-day="${k}">${truc[k]}</td></tr>`;
            }
            html += `</tbody></table>`;

            full.innerHTML = html;
            full.style.display = 'block';
            this.textContent = '‚ùå ·∫®n to√†n b·ªô';
            // save buttons
            full.querySelectorAll('.save-truc').forEach(btn => {
                btn.addEventListener('click', () => {
                    const day = btn.dataset.day;
                    const val = prompt("Nh·∫≠p n·ªôi dung tr·ª±c cho " + dayNames[day], truc[day]);
                    if (val !== null) {
                        truc[day] = val;
                        localStorage.setItem('lichTruc', JSON.stringify(truc));
                        renderTodayTKB();
                        // refresh full view
                        document.getElementById('showFullBtn').click();
                        document.getElementById('showFullBtn').click();
                    }
                });
            });
        });

        // init render
        renderTodayTKB();

        // re-render every minute (keeps up-to-date at 7:00 change)
        setInterval(renderTodayTKB, 60 * 1000);

        /* -------------------------
          Small accessibility: close menu with ESC
        ------------------------- */
        window.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                document.getElementById('menuPanel').style.display = 'none';
                document.getElementById('popup').classList.remove('open');
            }
        });
    </script>
</body>

</html>
